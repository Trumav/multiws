#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -U -f backup.sh 
#endif

static  char data [] = 
#define      shll_z	10
#define      shll	((&data[1]))
	"\005\166\111\017\200\106\243\016\201\250\023\203\001"
#define      opts_z	1
#define      opts	((&data[13]))
	"\037"
#define      inlo_z	3
#define      inlo	((&data[14]))
	"\065\360\110"
#define      chk2_z	19
#define      chk2	((&data[19]))
	"\014\200\211\016\113\212\064\321\070\124\260\133\234\101\137\123"
	"\372\042\136\336\154\223"
#define      xecc_z	15
#define      xecc	((&data[40]))
	"\324\043\204\264\076\243\043\145\107\213\363\307\056\232\061\355"
	"\043"
#define      msg2_z	19
#define      msg2	((&data[58]))
	"\104\121\337\275\060\253\135\342\222\135\157\113\054\335\242\206"
	"\050\267\356\236\226\233\243\204"
#define      text_z	6698
#define      text	((&data[236]))
	"\325\233\073\223\116\272\310\347\060\310\134\200\324\334\024\016"
	"\066\167\343\132\027\130\373\134\251\227\377\055\147\027\147\074"
	"\263\242\317\001\135\230\351\216\140\105\016\065\042\042\104\131"
	"\232\047\263\262\177\257\016\050\106\016\126\255\045\276\351\330"
	"\140\271\332\275\122\303\113\262\011\132\347\053\175\053\204\030"
	"\123\070\312\322\347\331\373\055\347\121\332\015\020\304\346\160"
	"\176\301\056\320\204\172\203\215\325\152\271\123\226\076\153\352"
	"\166\066\274\135\017\270\213\367\012\146\005\032\052\354\213\251"
	"\255\271\172\062\064\375\300\012\150\171\135\377\267\310\351\055"
	"\376\246\213\016\136\026\006\150\175\013\202\250\064\366\157\056"
	"\251\373\064\155\163\133\170\265\143\061\041\154\373\032\067\041"
	"\304\244\333\143\275\130\316\272\320\163\142\051\053\313\077\105"
	"\112\375\123\033\343\233\105\316\370\267\121\042\156\217\110\265"
	"\277\144\332\057\355\150\325\103\221\016\011\120\361\055\107\105"
	"\055\116\201\040\354\301\342\220\314\114\036\224\006\276\127\267"
	"\314\156\147\032\151\204\377\024\242\207\134\225\373\167\224\372"
	"\247\230\337\356\067\003\042\057\243\224\150\032\363\075\063\230"
	"\200\046\026\361\226\156\212\377\200\124\204\344\307\020\210\220"
	"\131\257\061\027\160\203\004\115\102\261\115\012\321\344\073\316"
	"\001\202\003\014\042\065\276\305\217\215\343\346\102\142\135\372"
	"\067\136\120\064\060\006\132\057\314\062\242\250\307\101\250\174"
	"\241\225\021\146\143\325\326\327\347\022\041\256\301\322\230\320"
	"\314\221\167\321\134\027\011\161\246\115\207\315\232\237\156\033"
	"\100\263\377\217\355\343\044\050\216\227\133\136\360\021\011\120"
	"\162\237\014\221\317\037\214\327\075\150\242\147\174\257\152\145"
	"\012\231\351\203\035\257\162\163\265\056\316\217\214\317\212\374"
	"\132\024\350\240\312\147\337\251\366\231\044\236\107\045\032\107"
	"\206\047\167\317\335\166\034\031\007\224\311\137\137\167\337\207"
	"\223\176\115\032\122\173\162\202\206\257\263\074\024\370\044\365"
	"\260\310\043\302\106\176\240\075\326\303\341\311\300\141\301\275"
	"\257\064\020\165\272\263\340\013\133\124\145\252\363\246\310\104"
	"\014\064\220\217\327\325\026\016\100\171\063\105\012\002\232\343"
	"\054\316\256\015\200\173\025\031\332\265\260\073\173\147\237\035"
	"\105\166\345\305\037\367\134\302\344\060\105\201\106\176\201\370"
	"\007\312\247\225\336\247\123\057\237\201\142\072\265\266\212\146"
	"\236\171\320\346\223\271\016\221\141\264\153\224\105\130\142\117"
	"\264\372\165\226\336\361\057\233\223\255\235\341\076\115\277\230"
	"\307\063\047\111\076\222\146\106\032\337\234\111\330\114\325\077"
	"\166\075\230\276\217\125\251\355\364\102\373\202\126\332\224\152"
	"\210\327\273\257\343\170\073\152\141\064\261\104\054\000\364\355"
	"\215\267\076\263\230\166\336\016\033\201\141\132\377\246\125\233"
	"\304\046\241\072\051\357\356\336\216\004\306\332\055\042\026\160"
	"\165\354\357\120\275\324\053\001\047\222\115\002\331\031\370\213"
	"\014\074\051\244\232\336\346\005\313\241\030\055\243\265\140\211"
	"\011\157\133\267\163\225\014\157\260\056\351\025\036\215\262\320"
	"\234\022\376\000\271\041\005\350\057\136\034\322\234\250\034\236"
	"\047\250\330\265\357\163\361\226\265\236\035\162\020\247\065\353"
	"\350\061\210\040\241\315\062\237\076\353\342\350\166\003\076\341"
	"\314\200\276\163\330\163\013\314\371\217\073\062\355\022\361\316"
	"\027\116\023\020\042\354\151\300\233\307\337\242\051\006\164\376"
	"\257\120\244\033\226\370\264\050\103\350\212\140\366\102\015\202"
	"\237\220\130\225\071\321\213\372\265\366\104\235\364\224\145\075"
	"\323\346\066\156\042\375\174\330\160\211\312\135\361\237\024\303"
	"\166\242\363\116\153\126\211\130\071\045\315\267\146\214\047\160"
	"\167\101\032\212\002\004\157\130\251\310\175\300\353\114\171\352"
	"\111\060\171\255\213\363\015\274\013\045\221\034\362\350\231\072"
	"\370\050\110\061\232\257\153\165\135\313\352\252\060\265\155\366"
	"\263\316\130\242\014\311\324\235\102\057\061\377\111\332\000\271"
	"\311\307\141\264\262\153\115\264\126\224\316\203\065\304\073\303"
	"\220\173\341\064\161\074\257\070\265\370\310\041\124\037\142\221"
	"\062\226\023\140\067\162\066\322\106\176\313\213\001\251\271\206"
	"\203\376\276\145\317\134\227\116\125\265\231\347\334\054\176\055"
	"\312\064\263\157\141\215\316\361\150\164\307\272\263\247\314\374"
	"\001\154\363\150\113\064\153\046\122\147\006\145\126\134\252\022"
	"\367\215\352\107\130\141\070\100\067\150\223\233\044\174\140\356"
	"\115\240\167\163\002\360\251\122\352\233\156\202\207\322\272\121"
	"\350\217\031\122\124\040\234\051\000\173\305\337\317\074\225\304"
	"\037\055\173\052\212\000\310\241\112\061\014\351\344\165\220\246"
	"\132\347\176\317\232\357\366\273\123\347\105\222\021\040\341\037"
	"\016\127\243\174\236\266\354\123\006\170\025\347\172\275\223\134"
	"\122\267\377\115\025\314\153\233\375\040\123\352\217\255\051\203"
	"\306\073\275\224\122\023\252\116\070\007\310\064\227\112\256\016"
	"\326\100\257\015\255\135\032\101\366\007\323\025\037\125\034\336"
	"\326\044\032\305\265\041\351\231\156\207\220\213\216\114\262\167"
	"\243\211\272\241\366\215\347\042\102\171\263\131\326\236\263\025"
	"\147\023\045\134\063\146\116\036\355\205\202\107\005\236\163\200"
	"\362\201\214\362\316\347\370\261\310\272\355\014\137\220\236\116"
	"\330\117\321\374\170\125\240\017\043\364\230\027\142\344\142\042"
	"\205\035\306\272\143\046\256\032\301\375\242\045\305\230\246\350"
	"\051\060\147\265\320\301\223\075\116\240\114\147\371\271\251\174"
	"\072\306\113\343\120\314\346\336\012\320\331\170\271\065\077\234"
	"\156\104\104\106\214\375\322\006\273\161\310\005\100\062\076\170"
	"\313\144\163\321\163\332\123\057\254\177\154\003\137\355\322\261"
	"\107\265\232\006\366\065\332\325\115\205\250\214\067\222\354\340"
	"\106\025\302\033\016\235\220\134\257\011\255\346\324\175\051\063"
	"\254\041\161\071\070\162\133\252\024\077\342\054\134\157\075\304"
	"\117\334\366\352\055\172\144\270\134\336\262\245\250\360\150\204"
	"\121\274\213\360\136\122\201\017\021\355\303\006\066\227\006\277"
	"\124\211\326\315\321\122\275\112\111\362\160\245\324\176\370\324"
	"\205\333\245\105\102\202\021\160\224\205\145\373\124\167\344\361"
	"\000\021\145\136\300\147\142\107\260\360\075\204\332\050\222\077"
	"\060\334\155\314\225\117\217\235\362\062\205\242\314\133\223\361"
	"\116\055\265\237\302\144\265\364\327\161\047\135\155\343\225\033"
	"\272\036\330\214\077\174\337\134\117\105\232\052\005\060\106\101"
	"\353\015\014\336\365\127\355\314\141\264\163\304\144\273\036\356"
	"\226\154\030\242\234\326\041\075\014\247\017\141\372\146\230\154"
	"\252\127\371\235\343\212\031\266\247\110\034\121\323\261\043\154"
	"\001\303\300\004\006\066\313\017\243\370\207\255\160\060\016\210"
	"\217\366\072\310\040\253\074\372\376\141\223\054\206\372\106\222"
	"\161\112\051\374\012\004\070\027\311\140\261\052\012\314\056\062"
	"\263\032\041\241\214\277\176\074\330\066\137\050\352\270\253\070"
	"\063\314\163\374\051\316\137\254\141\161\264\047\367\257\036\222"
	"\103\366\256\117\130\327\152\265\053\106\234\256\170\033\231\255"
	"\013\313\152\233\331\072\167\350\242\027\153\243\135\367\070\122"
	"\123\137\332\157\230\201\165\073\314\051\022\116\365\166\337\136"
	"\134\332\235\317\251\010\052\264\345\132\355\346\261\322\256\331"
	"\151\276\137\244\131\257\243\066\022\016\152\352\207\147\056\373"
	"\047\007\207\363\365\175\161\137\013\237\033\161\140\053\150\164"
	"\356\327\177\126\145\255\214\115\277\302\100\247\106\213\236\271"
	"\034\352\042\374\077\263\325\217\103\016\147\117\265\315\230\030"
	"\217\332\077\141\131\157\265\221\064\031\026\350\201\055\317\077"
	"\007\230\351\051\204\365\233\033\275\307\036\302\306\214\032\115"
	"\016\020\363\145\076\176\117\077\111\146\000\071\263\350\106\245"
	"\000\222\162\356\114\151\051\376\140\346\145\000\167\270\236\372"
	"\347\133\302\112\172\033\262\266\166\250\367\313\275\247\157\372"
	"\262\152\271\071\320\173\371\331\314\340\215\306\332\350\326\364"
	"\225\323\075\113\341\377\203\076\141\315\212\171\215\207\357\140"
	"\175\360\213\273\231\212\305\255\372\101\050\324\044\130\153\175"
	"\244\206\056\177\360\143\200\056\143\042\363\336\205\075\311\161"
	"\206\310\225\252\137\123\241\361\117\244\173\221\032\123\100\263"
	"\373\034\060\343\351\103\040\264\312\036\114\102\320\005\056\107"
	"\202\030\126\344\141\364\223\154\351\245\032\140\364\305\251\170"
	"\324\054\044\204\134\166\106\111\370\053\032\106\375\027\210\332"
	"\022\123\375\167\153\331\104\161\017\116\253\234\014\253\103\373"
	"\155\352\313\115\306\177\063\232\024\214\100\052\116\254\131\202"
	"\355\261\243\372\267\014\322\236\227\313\316\043\257\134\334\256"
	"\111\331\120\227\315\044\013\260\114\050\322\133\234\344\121\330"
	"\267\064\070\357\312\102\063\145\352\061\137\320\266\150\376\200"
	"\237\007\132\142\326\040\342\220\313\212\047\264\053\347\372\013"
	"\222\200\212\260\075\261\046\015\202\022\353\021\161\376\052\112"
	"\177\264\024\061\014\271\106\102\037\356\352\035\153\220\245\030"
	"\154\234\115\273\231\236\114\360\275\100\226\250\230\136\132\234"
	"\257\160\344\355\157\357\145\355\152\346\075\316\117\155\276\066"
	"\257\272\365\010\033\175\147\237\035\051\257\030\050\065\030\357"
	"\114\174\361\346\373\003\072\327\333\344\137\267\171\273\012\307"
	"\360\225\006\267\143\257\360\076\001\345\323\130\131\033\325\276"
	"\024\022\251\337\305\237\150\150\362\130\222\334\361\127\325\311"
	"\261\335\021\100\360\106\010\026\213\214\130\246\124\265\057\253"
	"\327\275\315\107\223\367\206\375\152\323\307\212\011\052\252\163"
	"\167\170\036\247\357\346\062\040\273\363\334\027\133\225\147\342"
	"\024\132\222\245\252\350\010\041\277\071\277\201\177\054\227\317"
	"\104\345\252\056\075\065\304\102\076\371\261\173\055\345\317\262"
	"\367\153\117\302\077\210\017\162\007\142\170\232\036\135\147\022"
	"\174\172\317\112\160\077\353\006\245\230\327\111\142\307\037\120"
	"\176\377\234\362\373\332\025\340\042\244\153\336\037\371\374\260"
	"\217\260\135\011\233\232\166\165\006\077\347\072\061\260\152\153"
	"\044\031\330\153\150\321\055\112\331\253\363\232\366\135\155\324"
	"\303\171\200\103\002\041\142\247\270\162\221\152\010\216\321\377"
	"\356\225\360\175\061\072\350\230\147\064\160\326\263\201\331\211"
	"\015\372\271\357\167\241\370\373\002\015\107\353\257\256\135\155"
	"\233\314\146\113\032\251\003\021\174\151\165\023\104\132\120\072"
	"\217\201\000\014\303\141\215\150\210\141\255\272\202\326\111\006"
	"\064\372\373\112\007\333\374\257\363\203\231\173\234\164\033\302"
	"\073\150\353\247\307\312\225\227\202\006\100\170\032\262\242\032"
	"\372\325\032\167\067\067\241\314\231\105\365\174\166\100\331\066"
	"\275\212\166\377\264\001\272\344\334\365\134\024\216\233\334\211"
	"\067\142\312\012\050\172\222\077\277\326\274\132\216\056\012\206"
	"\356\220\215\125\225\156\307\111\240\231\216\273\175\115\242\030"
	"\345\172\174\200\204\351\305\271\053\067\317\307\377\174\336\247"
	"\353\304\335\201\373\172\207\231\130\172\300\374\056\004\351\072"
	"\374\262\121\151\266\242\044\126\323\202\212\270\143\376\300\022"
	"\162\107\161\136\043\261\220\317\311\374\226\236\253\273\047\101"
	"\266\275\110\211\135\353\225\200\044\304\376\301\127\167\316\275"
	"\340\213\171\115\255\022\060\036\173\123\310\126\234\027\220\076"
	"\217\376\304\140\026\332\271\307\044\020\124\127\252\176\324\341"
	"\104\265\176\070\310\131\151\127\107\007\101\102\370\127\101\262"
	"\163\024\143\206\271\273\137\130\351\020\047\064\032\341\136\043"
	"\022\305\324\124\120\252\203\123\213\110\363\071\132\034\330\152"
	"\027\377\310\310\033\362\103\213\140\346\172\176\001\337\150\355"
	"\040\315\064\043\137\234\050\045\145\045\045\217\342\213\140\011"
	"\137\127\024\253\164\142\332\353\307\014\012\152\213\157\254\340"
	"\166\313\101\003\151\134\231\002\211\015\022\117\143\103\014\372"
	"\257\145\320\016\035\077\242\224\357\216\377\326\265\340\172\100"
	"\143\247\216\170\355\055\356\067\103\035\157\217\131\215\273\130"
	"\157\056\216\233\161\136\021\151\236\020\233\055\301\376\067\027"
	"\126\224\043\076\364\344\143\316\103\330\377\245\244\377\377\106"
	"\063\127\316\100\175\157\345\142\145\113\034\236\247\135\273\064"
	"\024\212\345\132\175\324\122\341\330\111\004\220\234\262\115\373"
	"\144\053\076\255\046\244\046\264\356\362\320\304\005\014\041\152"
	"\264\015\354\373\014\300\163\217\122\027\160\215\377\266\275\236"
	"\062\335\321\162\122\135\246\244\040\061\012\005\234\127\175\210"
	"\367\061\357\004\266\122\172\267\332\076\107\310\011\002\104\174"
	"\243\273\062\332\041\222\030\107\377\024\145\146\256\125\147\152"
	"\151\256\266\206\122\357\244\047\026\361\357\315\136\047\033\030"
	"\222\121\377\372\152\316\341\205\213\313\106\327\037\132\240\016"
	"\044\251\234\336\035\042\236\113\001\244\031\132\035\116\204\355"
	"\011\355\006\253\054\360\200\024\035\102\243\070\114\233\045\011"
	"\060\344\244\265\153\152\233\323\203\277\156\045\107\216\324\055"
	"\007\204\062\310\110\202\311\063\222\020\002\065\277\301\323\267"
	"\175\132\013\034\232\021\326\125\170\357\357\374\376\006\005\325"
	"\203\223\013\376\244\267\344\211\153\367\012\365\053\232\224\051"
	"\011\156\171\004\024\052\050\373\143\114\166\045\107\321\155\017"
	"\344\247\374\025\212\150\047\142\305\015\073\022\007\235\323\376"
	"\372\244\331\006\356\237\113\351\263\231\115\101\077\303\077\134"
	"\041\365\265\172\045\371\041\062\336\364\311\365\332\343\177\144"
	"\141\170\310\317\121\161\242\174\262\045\364\377\077\231\047\016"
	"\203\347\246\375\076\267\123\032\137\357\335\071\055\113\103\147"
	"\313\250\102\067\025\331\140\351\107\055\061\100\112\171\367\355"
	"\050\301\115\104\265\121\036\104\123\367\176\114\000\163\061\216"
	"\014\305\334\146\207\245\115\376\250\354\355\221\027\343\072\242"
	"\236\026\357\157\345\100\353\020\352\354\324\221\267\004\251\203"
	"\157\215\050\120\260\073\026\135\017\237\021\042\166\076\250\177"
	"\232\331\336\072\156\073\046\061\237\100\366\050\255\005\335\355"
	"\363\251\124\103\143\364\063\120\051\154\370\035\145\165\372\215"
	"\203\206\162\171\173\244\204\237\017\157\226\223\345\345\364\027"
	"\047\013\110\161\077\330\372\051\272\272\237\102\065\024\364\234"
	"\372\355\217\202\017\044\034\057\347\167\357\360\036\373\062\204"
	"\332\020\110\265\220\163\367\274\331\330\356\317\314\166\143\041"
	"\133\374\034\267\200\313\312\036\252\026\034\363\270\320\074\000"
	"\262\062\211\260\132\052\101\225\011\100\375\277\260\204\157\274"
	"\261\310\236\247\272\173\361\022\131\026\125\166\175\001\075\100"
	"\214\033\155\106\170\200\334\231\245\376\342\031\360\331\143\111"
	"\271\145\241\331\333\274\234\015\121\302\341\043\151\141\127\177"
	"\031\325\063\121\026\302\015\172\064\253\135\147\112\002\003\125"
	"\072\044\344\077\137\041\352\234\254\132\112\206\171\022\055\200"
	"\032\106\335\154\102\166\140\164\316\167\340\307\057\234\125\045"
	"\134\077\264\234\250\213\027\263\105\002\252\076\046\024\330\126"
	"\056\225\204\010\315\351\250\363\112\051\011\222\362\231\127\275"
	"\326\230\253\123\143\215\033\372\176\042\203\226\316\221\020\200"
	"\067\302\000\133\234\152\101\120\237\225\000\012\263\311\256\372"
	"\311\145\134\221\111\106\343\311\346\005\101\100\156\046\115\375"
	"\162\057\001\366\332\301\123\150\044\351\024\020\221\247\016\234"
	"\064\223\066\327\324\211\347\233\213\177\315\217\304\362\253\315"
	"\235\052\003\021\102\004\250\011\205\372\246\023\363\047\036\242"
	"\011\342\235\110\317\236\045\006\261\270\372\376\145\010\027\116"
	"\255\274\106\022\115\227\254\262\061\272\211\275\101\035\050\175"
	"\361\111\367\054\006\262\243\340\315\201\054\105\005\176\055\101"
	"\212\040\366\212\361\203\215\377\336\207\255\123\304\273\230\332"
	"\270\133\011\114\302\107\163\146\067\055\271\131\105\217\006\151"
	"\320\057\377\011\310\210\016\170\356\154\101\042\322\210\012\164"
	"\010\072\064\045\327\035\337\370\266\056\107\114\106\337\263\247"
	"\201\206\061\362\171\063\306\134\171\340\075\153\135\250\106\225"
	"\076\224\155\255\022\327\141\231\045\342\132\031\201\007\275\272"
	"\051\321\130\343\244\103\140\213\101\335\034\062\205\141\057\037"
	"\143\113\206\144\257\071\306\075\365\027\106\014\336\220\322\147"
	"\344\063\063\260\046\110\361\010\066\376\373\202\044\362\025\135"
	"\115\274\043\213\227\065\300\363\272\146\211\165\330\317\167\346"
	"\051\144\027\205\233\252\334\072\207\105\336\265\257\104\262\033"
	"\254\171\067\037\336\327\051\102\360\333\046\364\001\141\105\312"
	"\156\026\030\177\355\230\225\016\162\015\142\354\164\371\130\133"
	"\255\006\355\043\051\274\046\322\375\334\107\257\215\356\043\025"
	"\175\142\367\323\077\271\234\375\243\360\163\355\176\002\167\200"
	"\224\007\231\354\214\270\011\364\332\043\074\376\243\132\312\205"
	"\036\270\217\361\205\001\066\015\021\332\374\010\315\314\275\200"
	"\150\235\301\201\046\027\200\212\256\164\025\127\216\300\363\236"
	"\177\314\112\223\072\163\263\004\261\370\327\244\067\234\335\224"
	"\120\373\043\364\215\140\316\300\114\153\252\144\201\325\371\102"
	"\307\267\225\102\065\075\362\207\251\226\154\064\067\223\067\001"
	"\303\257\215\203\226\320\062\105\030\245\325\337\157\326\372\137"
	"\240\024\220\366\111\221\277\273\166\063\224\126\020\024\001\340"
	"\220\113\367\016\276\331\217\371\274\072\226\025\234\323\205\030"
	"\122\322\332\071\102\231\046\071\271\317\065\314\306\227\270\265"
	"\144\021\353\075\236\360\367\135\262\144\050\003\025\127\332\352"
	"\311\224\155\112\173\213\026\353\163\131\270\266\375\055\240\153"
	"\157\214\334\057\252\170\241\277\322\025\061\213\275\147\121\215"
	"\036\252\152\021\345\306\236\316\231\064\323\252\167\146\137\330"
	"\044\102\246\076\034\001\211\134\121\246\152\054\350\365\026\077"
	"\000\366\070\316\272\214\225\241\174\024\076\231\076\156\321\051"
	"\072\317\131\373\061\005\257\307\137\170\367\375\166\021\376\131"
	"\220\055\174\345\127\353\005\300\171\340\230\307\270\320\132\303"
	"\311\046\323\376\027\026\032\120\141\056\125\046\216\026\147\353"
	"\204\262\214\120\212\155\113\032\071\006\351\221\021\113\070\330"
	"\103\101\110\073\020\243\335\356\360\022\214\215\042\264\147\161"
	"\223\217\344\016\013\015\374\101\167\317\175\362\161\315\346\136"
	"\104\156\057\235\360\045\231\246\236\003\021\005\152\347\251\340"
	"\143\077\327\332\030\266\111\353\141\355\056\255\143\133\323\243"
	"\256\374\261\115\262\160\315\101\157\325\356\165\321\115\154\103"
	"\241\252\152\075\225\343\061\223\134\117\007\202\265\236\014\040"
	"\007\275\165\267\076\066\127\253\262\327\125\256\004\167\121\107"
	"\125\245\031\265\007\317\034\106\200\357\013\022\370\060\111\117"
	"\156\265\116\167\303\246\026\356\342\311\314\000\347\337\141\254"
	"\105\227\152\272\350\323\233\174\132\175\141\057\060\264\317\246"
	"\175\246\176\233\073\232\265\220\315\225\145\154\150\261\060\271"
	"\102\266\110\134\223\023\011\155\142\271\121\302\232\152\032\222"
	"\230\307\142\156\247\266\301\171\075\264\363\352\017\102\320\263"
	"\267\255\345\377\047\227\237\027\154\326\354\057\350\141\213\133"
	"\024\076\101\103\127\044\332\221\104\067\056\136\200\152\117\353"
	"\137\337\046\223\152\053\130\155\003\015\123\060\044\113\146\054"
	"\172\021\312\061\276\022\351\272\273\356\264\144\003\273\334\010"
	"\055\102\027\160\366\204\027\125\044\311\266\271\272\277\335\040"
	"\347\310\306\351\054\076\316\147\065\267\101\363\110\351\113\223"
	"\256\006\321\262\356\071\164\022\316\311\252\101\001\227\247\333"
	"\036\135\344\240\275\070\067\376\331\115\267\205\257\175\326\226"
	"\306\101\346\335\163\327\260\022\065\102\276\370\251\130\327\162"
	"\124\307\367\123\336\125\057\312\153\160\337\037\147\200\011\110"
	"\127\364\177\175\271\043\101\104\057\211\010\345\044\002\012\243"
	"\346\075\022\235\375\024\146\116\052\034\242\216\213\234\215\175"
	"\167\174\044\152\126\323\213\341\120\164\346\104\330\052\113\033"
	"\166\330\136\016\341\057\343\207\046\307\067\222\373\124\077\120"
	"\235\206\375\213\016\241\004\203\051\126\201\076\305\125\030\144"
	"\140\134\373\373\317\172\107\134\235\060\221\364\317\010\304\202"
	"\135\057\253\323\055\103\116\022\207\216\143\144\350\043\040\367"
	"\035\022\016\247\112\016\237\123\107\073\173\133\004\242\207\203"
	"\030\133\037\013\262\273\173\036\052\065\100\223\312\247\265\360"
	"\053\167\375\344\100\322\102\316\270\300\251\146\056\005\224\010"
	"\225\114\051\167\060\003\105\242\245\231\035\304\122\222\272\044"
	"\342\264\255\335\340\367\034\352\125\043\104\331\254\002\313\051"
	"\277\057\306\225\205\101\161\364\143\222\344\217\301\363\233\317"
	"\230\137\204\224\217\006\264\011\176\371\127\125\167\247\260\204"
	"\343\120\146\013\306\333\153\036\264\165\064\351\074\110\235\121"
	"\311\355\362\033\116\021\376\105\053\126\006\273\275\053\005\005"
	"\013\367\247\003\303\277\350\177\256\025\164\301\156\254\221\126"
	"\152\132\034\260\077\147\015\000\326\223\361\205\063\050\122\070"
	"\302\021\252\244\314\360\324\276\054\164\040\105\175\116\332\127"
	"\003\161\322\167\125\272\062\147\256\165\377\244\011\067\070\217"
	"\146\360\040\123\235\116\030\313\041\240\277\035\310\157\215\277"
	"\177\142\346\367\150\067\071\311\076\000\153\164\324\126\076\322"
	"\063\372\270\055\037\223\252\375\373\350\360\154\356\157\152\214"
	"\136\267\255\244\151\002\042\354\165\322\042\261\145\306\142\166"
	"\266\067\035\310\071\007\056\143\364\236\007\011\112\335\032\267"
	"\310\171\163\032\223\122\220\247\333\055\032\160\122\333\114\250"
	"\177\346\333\147\355\265\056\001\351\205\222\006\375\246\112\324"
	"\222\315\254\023\014\001\011\035\342\250\032\222\341\121\326\121"
	"\075\361\347\153\105\246\110\234\313\043\174\344\016\124\314\322"
	"\364\202\213\357\115\045\167\236\171\107\171\151\066\324\345\126"
	"\302\344\037\150\302\216\336\304\045\160\316\011\103\314\172\267"
	"\057\210\105\244\260\251\052\257\333\051\050\376\105\077\026\114"
	"\314\163\276\204\163\056\144\126\262\010\214\130\070\130\322\101"
	"\301\201\147\153\257\321\033\215\210\166\070\132\220\223\152\060"
	"\150\000\320\123\141\251\172\203\104\016\141\202\130\124\110\175"
	"\312\235\333\044\040\241\275\004\367\051\011\216\021\112\304\326"
	"\224\264\263\262\262\075\002\276\021\226\157\106\173\022\357\106"
	"\071\261\236\354\146\321\376\213\056\006\220\070\346\261\275\220"
	"\311\005\201\111\377\100\071\170\016\250\165\360\060\206\200\376"
	"\174\263\016\362\343\037\335\140\336\237\233\155\355\372\163\237"
	"\271\365\174\140\235\200\107\374\354\317\056\317\275\000\145\266"
	"\034\307\063\157\043\174\324\107\173\331\046\002\314\020\335\223"
	"\240\315\044\214\364\137\117\366\372\064\171\170\357\026\215\001"
	"\153\006\005\012\054\272\373\211\215\360\374\367\062\366\325\176"
	"\240\144\276\076\117\057\346\146\236\122\247\214\324\161\335\011"
	"\265\232\355\157\070\210\040\015\322\315\224\217\075\252\132\277"
	"\321\240\004\332\105\327\312\066\315\111\013\145\072\274\153\177"
	"\273\133\327\162\313\353\125\230\144\003\162\152\174\243\226\312"
	"\040\245\324\127\101\325\353\135\022\031\246\167\102\333\240\120"
	"\312\054\132\003\002\034\062\317\035\023\105\147\062\200\322\032"
	"\314\014\270\366\354\003\320\233\115\325\103\374\300\100\300\256"
	"\033\077\230\312\212\332\054\013\026\317\311\215\342\216\200\311"
	"\046\231\006\002\251\274\321\351\207\101\263\206\307\101\124\372"
	"\313\221\030\214\356\234\362\050\005\073\005\365\016\305\362\060"
	"\171\005\256\150\101\276\230\231\322\230\332\307\206\331\370\103"
	"\375\031\022\024\261\124\056\016\202\356\344\175\044\026\111\207"
	"\010\114\115\267\070\024\176\004\276\162\123\344\050\015\266\350"
	"\243\030\101\002\277\163\045\217\122\040\230\235\243\014\144\067"
	"\133\032\171\136\215\110\365\026\330\122\067\215\004\132\057\307"
	"\056\312\150\114\141\352\117\165\115\137\113\207\273\265\260\356"
	"\011\053\246\263\374\125\270\241\344\074\252\004\365\107\027\021"
	"\143\303\032\163\140\026\017\156\165\040\107\300\201\201\021\111"
	"\213\200\155\326\253\360\376\066\321\221\360\015\037\353\021\323"
	"\234\040\010\246\240\153\001\050\266\033\332\377\114\216\142\210"
	"\245\146\032\266\037\201\014\236\223\345\046\037\043\144\061\373"
	"\177\313\014\373\247\365\053\351\012\271\232\270\036\225\261\322"
	"\025\106\034\264\003\064\112\032\364\262\036\370\345\110\261\342"
	"\100\265\265\076\145\305\163\223\372\354\252\301\062\111\330\161"
	"\014\336\172\177\052\341\346\173\174\175\037\313\123\154\006\122"
	"\177\146\067\056\021\341\330\153\305\056\044\376\375\114\340\213"
	"\027\031\030\147\246\352\043\042\323\003\340\026\371\325\257\214"
	"\256\371\310\053\305\257\242\025\246\302\107\053\074\240\067\250"
	"\042\174\210\113\136\044\307\330\177\212\014\343\276\373\274\321"
	"\324\253\202\210\126\275\212\361\331\002\106\336\370\036\227\053"
	"\172\017\316\314\237\213\146\017\175\225\153\243\053\176\033\350"
	"\230\315\034\030\162\020\144\172\347\373\270\021\142\351\360\211"
	"\020\021\241\025\017\050\271\075\174\273\133\072\167\221\132\016"
	"\016\024\352\060\021\144\223\210\027\343\360\045\043\332\345\003"
	"\062\053\256\220\014\017\332\336\045\372\302\122\124\345\150\234"
	"\115\273\360\200\226\063\015\065\073\315\166\252\217\366\057\262"
	"\300\220\076\162\314\135\263\050\327\247\130\012\115\060\367\240"
	"\056\215\331\172\362\051\334\332\117\040\273\155\005\313\267\243"
	"\066\104\012\146\114\131\054\201\354\176\115\163\313\321\070\074"
	"\210\057\232\240\202\346\176\124\370\252\037\276\022\101\246\313"
	"\342\010\150\317\116\373\211\036\016\170\100\041\063\200\047\341"
	"\273\014\034\006\367\201\304\024\321\032\072\302\253\333\237\115"
	"\244\062\222\220\010\277\340\132\022\106\045\131\033\152\124\205"
	"\147\123\041\340\165\342\062\037\354\247\265\014\311\140\004\150"
	"\340\226\317\075\074\354\334\144\363\276\345\231\036\264\030\246"
	"\157\264\265\231\343\361\145\015\156\240\077\126\051\361\363\163"
	"\000\022\350\345\172\026\275\173\022\010\331\067\073\151\241\332"
	"\067\213\006\252\121\173\263\264\243\102\246\120\010\145\145\117"
	"\361\217\153\156\067\120\321\222\003\173\225\142\062\063\044\312"
	"\064\151\357\121\042\212\362\270\072\220\071\062\357\136\215\134"
	"\011\070\003\155\060\162\147\376\301\073\034\017\261\140\353\070"
	"\257\171\313\300\237\206\041\032\200\033\064\004\144\346\312\272"
	"\044\226\104\245\234\277\145\331\047\151\145\335\375\054\144\156"
	"\307\314\171\071\212\073\012\001\360\276\373\015\035\161\326\001"
	"\103\126\361\240\170\172\201\045\364\150\276\225\274\202\342\325"
	"\213\152\054\360\307\202\200\232\060\026\024\250\247\063\332\356"
	"\366\045\133\016\020\142\073\070\072\034\305\146\223\336\041\326"
	"\360\103\261\170\034\334\244\046\145\116\210\035\163\311\234\130"
	"\026\113\072\247\044\350\120\010\173\067\072\153\036\306\341\170"
	"\274\365\241\174\377\102\050\170\337\006\213\077\376\246\027\157"
	"\054\222\207\067\305\373\164\255\373\175\043\301\204\274\270\205"
	"\103\072\252\217\037\170\050\350\015\346\053\326\226\350\212\006"
	"\174\356\150\154\235\067\254\276\000\021\160\247\317\210\272\176"
	"\344\011\251\367\026\202\251\335\234\366\172\147\263\036\340\120"
	"\100\064\070\247\040\064\325\047\077\362\226\130\340\042\176\363"
	"\210\120\066\167\320\151\333\036\050\075\132\274\245\075\170\157"
	"\254\240\107\243\233\037\147\332\316\141\066\114\260\215\337\203"
	"\334\302\223\015\214\105\007\172\227\077\016\250\103\177\351\170"
	"\031\055\222\073\107\054\107\047\020\376\245\177\172\351\262\254"
	"\122\056\164\000\256\004\237\317\064\053\245\307\026\313\361\212"
	"\016\334\002\245\321\122\007\243\146\342\120\161\025\374\341\156"
	"\152\322\301\216\236\016\027\051\271\077\031\070\100\133\110\313"
	"\102\063\100\161\011\025\252\277\077\310\137\064\163\312\200\160"
	"\272\157\031\333\046\220\335\045\022\051\034\263\145\345\273\115"
	"\240\141\316\317\165\033\114\100\261\013\176\002\232\117\333\203"
	"\117\210\176\001\243\375\103\161\304\020\341\371\362\230\132\047"
	"\343\031\127\226\221\065\122\057\143\203\231\077\357\111\151\064"
	"\362\073\371\356\165\116\377\041\152\024\347\373\005\344\364\100"
	"\346\060\362\206\140\245\012\243\343\264\250\160\171\321\304\145"
	"\010\353\041\271\074\355\252\335\003\145\231\073\276\152\361\353"
	"\247\212\252\030\016\114\057\273\113\302\327\061\176\353\146\163"
	"\122\331\316\132\170\257\352\255\101\264\215\355\314\341\277\270"
	"\334\112\371\170\332\257\313\126\307\214\124\232\052\267\226\167"
	"\246\221\043\077\166\103\036\024\017\011\131\120\115\003\171\073"
	"\276\274\321\315\145\047\107\171\141\214\143\147\145\220\040\261"
	"\010\251\050\056\263\372\030\353\276\152\066\365\373\345\122\035"
	"\045\171\075\160\156\125\263\327\375\172\306\043\124\177\271\151"
	"\044\241\251\005\003\333\065\230\361\030\117\120\115\254\040\323"
	"\126\025\256\367\067\045\370\322\317\031\025\333\236\173\373\146"
	"\212\242\266\260\175\127\150\325\147\331\245\031\261\012\376\064"
	"\201\103\153\261\053\122\111\165\025\115\303\223\133\271\212\015"
	"\264\172\106\117\260\306\263\026\273\016\117\064\133\076\077\173"
	"\075\070\152\107\264\071\130\002\052\226\000\050\122\366\141\254"
	"\114\365\162\374\370\167\004\146\353\347\241\063\041\076\367\212"
	"\015\024\133\154\245\134\210\260\023\105\036\144\056\313\233\071"
	"\230\146\126\330\326\101\135\016\232\077\176\243\352\141\144\044"
	"\040\351\255\036\211\251\277\064\162\073\063\211\256\301\341\302"
	"\102\301\253\037\235\003\256\315\220\216\135\174\357\111\203\306"
	"\303\367\144\215\047\222\144\305\155\354\236\325\336\376\303\352"
	"\125\111\111\356\267\057\370\015\121\245\307\313\327\374\311\227"
	"\006\061\021\143\060\310\054\032\366\053\300\202\071\036\231\077"
	"\206\026\113\011\276\103\026\020\351\336\334\301\332\245\130\341"
	"\326\152\104\007\063\161\041\052\234\341\254\326\000\105\026\206"
	"\134\141\220\033\245\247\053\217\205\007\120\140\254\251\101\203"
	"\023\206\212\107\367\254\161\223\215\035\151\216\143\177\024\300"
	"\341\245\333\207\114\006\027\321\016\147\061\272\021\163\076\045"
	"\371\311\154\360\165\335\204\003\373\356\221\137\155\246\037\117"
	"\113\372\327\230\001\356\151\017\126\233\311\147\016\010\214\010"
	"\321\370\370\106\326\174\112\321\152\333\060\330\202\117\050\316"
	"\112\377\146\113\356\320\132\104\153\044\253\172\054\070\202\376"
	"\060\173\105\006\370\217\327\142\153\010\073\356\130\143\274\242"
	"\143\042\356\121\362\111\226\136\155\102\331\232\172\134\230\252"
	"\327\336\261\317\156\211\062\331\221\156\307\352\321\204\214\065"
	"\246\173\207\231\304\035\367\061\137\321\314\331\055\145\204\005"
	"\103\065\325\261\277\010\213\120\166\123\073\110\327\307\175\175"
	"\102\004\026\007\041\016\070\201\337\005\133\015\152\337\023\256"
	"\025\350\137\324\361\352\045\147\075\140\257\024\050\054\222\153"
	"\061\251\162\123\267\253\324\227\260\057\244\033\017\270\311\045"
	"\240\051\371\221\023\037\371\121\200\250\146\251\325\370\025\006"
	"\242\207\131\131\063\056\360\344\136\225\000\156\116\311\223\356"
	"\362\215\200\006\254\172\130\055\043\276\327\370\267\354\377\131"
	"\164\131\263\247\210\244\214\346\072\214\124\210\126\347\166\111"
	"\164\367\117\041\162\247\117\225\146\046\215\035\022\215"
#define      tst1_z	22
#define      tst1	((&data[7313]))
	"\052\056\156\245\036\163\215\025\041\201\113\370\315\117\221\026"
	"\171\322\226\324\073\225\245\351\005\316\273\125\010\110"
#define      rlax_z	1
#define      rlax	((&data[7340]))
	"\010"
#define      chk1_z	22
#define      chk1	((&data[7341]))
	"\000\246\210\354\255\276\146\311\123\160\033\206\370\263\360\016"
	"\055\110\134\376\064\165\006\377\067\050\161"
#define      tst2_z	19
#define      tst2	((&data[7370]))
	"\105\236\250\271\345\173\013\264\064\360\033\042\311\361\274\113"
	"\056\263\055\270\045"
#define      pswd_z	256
#define      pswd	((&data[7414]))
	"\042\333\070\011\006\146\170\325\042\315\336\152\167\156\011\011"
	"\166\361\020\166\050\070\350\010\260\231\333\306\266\116\151\343"
	"\270\015\263\366\044\011\100\343\245\242\365\146\334\202\131\014"
	"\316\211\204\043\015\371\210\313\222\143\222\110\262\373\053\152"
	"\011\337\140\055\350\241\021\216\104\007\365\040\212\117\054\130"
	"\331\260\173\347\251\003\262\073\147\104\204\032\077\257\205\110"
	"\216\346\166\167\207\207\006\313\217\373\354\031\112\031\162\043"
	"\312\355\012\163\361\274\257\131\001\063\164\100\343\371\211\161"
	"\337\377\350\147\207\356\063\026\352\040\060\064\071\242\130\003"
	"\220\143\167\202\040\046\334\041\132\120\141\075\111\353\257\051"
	"\353\227\221\162\206\304\211\161\344\272\246\035\134\376\041\355"
	"\142\230\157\202\277\113\243\032\234\005\130\345\361\007\017\334"
	"\237\240\117\046\145\330\227\111\223\075\147\357\073\210\335\236"
	"\041\115\040\340\231\304\372\065\312\123\033\273\132\052\227\371"
	"\313\346\040\060\277\267\172\122\364\341\102\060\152\040\316\213"
	"\155\357\154\006\263\147\073\175\272\126\071\025\201\321\017\114"
	"\270\057\175\167\346\367\312\333\331\015\013\103\055\332\317\232"
	"\311\074\240\175\244\334\372\137\063\357\116\117\204\261\000\247"
	"\215\070\260\223\237\050\150\301\366\106\053\156\265\065\170\054"
	"\046\210\242\117\301\213\127\161\173\245\300\377\127\300\247\344"
	"\371\127\170\230\200"
#define      msg1_z	65
#define      msg1	((&data[7719]))
	"\047\205\346\334\272\043\151\155\245\142\032\272\125\311\107\351"
	"\254\032\247\143\274\127\031\234\160\234\237\172\124\104\344\330"
	"\116\332\155\146\227\306\247\070\306\252\301\144\304\200\061\240"
	"\070\361\170\255\213\227\334\120\154\123\002\254\102\266\055\217"
	"\235\115\054\364\146\306\136\010\340\346\253\060\247"
#define      lsto_z	1
#define      lsto	((&data[7791]))
	"\042"
#define      date_z	1
#define      date	((&data[7792]))
	"\032"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	0	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
