#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -U -f menu-backup.sh 
#endif

static  char data [] = 
#define      msg2_z	19
#define      msg2	((&data[4]))
	"\147\105\322\162\175\154\037\061\362\302\337\071\372\066\242\206"
	"\005\225\070\156\105\341\127\177\000\100\071"
#define      tst2_z	19
#define      tst2	((&data[27]))
	"\301\137\210\170\054\336\233\164\274\242\337\355\245\243\006\121"
	"\042\205\276\046\227\271\141"
#define      chk2_z	19
#define      chk2	((&data[52]))
	"\062\100\344\021\275\017\176\353\021\246\140\011\241\261\251\157"
	"\375\023\172\004\331"
#define      xecc_z	15
#define      xecc	((&data[72]))
	"\072\157\276\150\150\257\127\375\301\114\075\031\045\243\332\351"
	"\006"
#define      pswd_z	256
#define      pswd	((&data[107]))
	"\225\053\003\375\161\326\157\360\326\257\051\277\304\372\345\134"
	"\264\107\111\036\060\251\276\320\123\346\106\062\154\060\013\273"
	"\336\147\204\236\362\240\313\057\114\134\307\113\155\020\010\236"
	"\036\031\274\116\302\173\036\026\141\144\111\316\225\124\211\164"
	"\273\015\022\256\256\335\335\372\072\245\106\247\265\116\106\323"
	"\150\002\042\053\175\100\101\337\245\212\255\072\337\067\256\233"
	"\105\301\111\363\236\047\356\331\314\065\200\202\204\307\126\354"
	"\311\170\027\107\270\131\047\135\343\325\230\302\014\106\136\121"
	"\010\247\105\246\317\063\200\234\151\000\036\355\310\164\331\221"
	"\354\361\331\245\112\000\003\056\326\233\361\342\342\117\064\352"
	"\366\172\221\305\256\021\141\027\022\200\004\332\365\335\154\341"
	"\316\106\207\031\107\213\107\035\047\070\000\011\207\064\364\176"
	"\256\206\104\135\230\245\164\252\046\170\205\033\125\362\375\044"
	"\070\204\075\177\017\205\234\066\275\234\100\105\321\065\303\200"
	"\273\007\335\123\255\121\376\323\311\204\356\037\166\354\104\256"
	"\160\202\056\200\007\313\267\305\147\370\012\071\055\315\271\351"
	"\325\227\074\202\351\073\126\263\277\105\323\065\061\027\344\242"
	"\232\022\042\041\147\174\141\276\340\271\371\347\254"
#define      inlo_z	3
#define      inlo	((&data[373]))
	"\100\150\157"
#define      lsto_z	1
#define      lsto	((&data[376]))
	"\333"
#define      msg1_z	65
#define      msg1	((&data[392]))
	"\323\300\135\375\200\042\367\146\176\253\255\310\314\024\105\162"
	"\244\277\136\253\332\132\276\010\106\204\215\116\213\153\021\220"
	"\263\234\211\163\142\276\242\050\374\240\043\046\315\140\236\065"
	"\036\235\271\024\007\013\213\165\261\010\202\057\322\134\323\326"
	"\135\322\247\150\201\173\223\167\273\270\115\155\355\113\021\103"
	"\056\322\045\347\313\014\224\022\035\325\204"
#define      date_z	1
#define      date	((&data[468]))
	"\132"
#define      shll_z	10
#define      shll	((&data[471]))
	"\333\040\013\174\211\275\015\351\027\110\066\153"
#define      tst1_z	22
#define      tst1	((&data[483]))
	"\061\301\207\037\055\322\042\207\162\206\342\015\036\240\220\377"
	"\334\113\314\125\153\334\142\037\301"
#define      text_z	3971
#define      text	((&data[936]))
	"\251\203\316\330\126\364\300\042\001\124\065\036\052\272\117\077"
	"\042\152\001\137\105\042\230\241\144\312\143\045\247\322\257\121"
	"\126\175\051\255\161\351\320\162\076\005\220\150\277\340\247\342"
	"\112\251\101\220\313\332\062\057\244\225\125\113\150\004\234\277"
	"\201\305\155\363\257\075\146\355\102\367\126\002\327\375\344\041"
	"\246\046\261\162\000\343\242\244\171\367\360\342\374\215\242\175"
	"\122\017\161\002\114\327\357\217\317\105\221\246\103\166\307\352"
	"\235\171\134\235\134\376\102\326\365\063\271\361\300\133\157\023"
	"\152\341\025\266\271\005\105\210\113\327\056\216\116\366\171\353"
	"\157\325\211\314\323\314\243\311\377\134\273\277\267\053\323\041"
	"\015\351\330\306\356\035\117\072\365\175\310\103\164\101\057\344"
	"\027\270\261\353\204\124\265\204\260\161\104\150\234\027\211\252"
	"\000\141\160\357\177\300\051\165\076\362\271\262\064\350\226\113"
	"\240\107\066\045\234\354\252\114\135\356\265\372\005\077\244\006"
	"\240\025\365\040\325\036\225\023\020\117\305\104\067\134\220\330"
	"\243\307\376\100\263\250\215\020\226\102\012\234\201\257\242\042"
	"\304\227\102\231\266\330\254\307\047\161\014\137\316\234\067\162"
	"\144\065\262\027\335\077\050\164\201\063\020\002\342\262\045\246"
	"\112\147\077\001\100\354\310\150\136\324\310\054\161\377\236\325"
	"\065\121\355\023\220\025\207\021\111\230\024\053\113\071\322\225"
	"\241\022\226\342\376\137\113\135\063\023\211\244\023\050\171\111"
	"\171\146\134\012\174\344\033\305\174\060\361\307\152\304\134\014"
	"\326\363\356\325\122\072\063\206\116\274\052\141\345\244\252\137"
	"\013\007\151\207\353\205\115\147\266\077\056\040\003\213\054\332"
	"\177\033\257\322\125\342\130\244\237\203\005\205\047\260\344\062"
	"\270\116\272\243\323\007\013\211\107\072\252\112\305\326\044\105"
	"\362\324\027\110\266\160\354\126\363\362\333\032\243\300\042\014"
	"\000\174\125\123\017\300\113\003\304\061\014\176\051\373\334\066"
	"\131\240\220\101\065\145\372\220\112\245\154\175\170\307\043\152"
	"\342\043\361\077\227\211\016\242\166\316\357\240\334\337\245\300"
	"\041\355\321\263\225\067\371\000\063\074\143\237\312\117\341\300"
	"\160\011\211\010\045\346\270\133\346\230\063\266\153\340\054\107"
	"\321\315\053\246\104\116\032\376\052\054\112\016\263\034\162\064"
	"\373\104\156\254\331\054\344\166\034\357\336\141\065\246\173\237"
	"\302\116\277\320\006\206\351\017\003\334\133\154\103\172\172\231"
	"\335\136\055\067\133\354\376\141\342\225\243\057\202\366\056\320"
	"\213\264\335\025\213\364\205\300\221\226\350\203\317\252\320\327"
	"\144\223\334\063\306\364\171\300\321\225\236\106\067\200\234\225"
	"\023\101\133\214\266\230\212\160\005\130\112\156\345\216\155\324"
	"\006\234\216\206\042\161\220\325\274\362\056\115\062\237\103\033"
	"\362\036\134\327\151\004\255\353\073\311\335\360\176\316\217\022"
	"\127\231\024\003\310\243\315\224\071\025\260\134\031\347\273\271"
	"\006\000\126\166\230\313\226\040\256\274\313\115\245\246\121\206"
	"\133\012\226\346\174\030\007\246\057\131\236\135\310\211\050\325"
	"\300\252\330\166\120\176\134\356\330\277\335\123\023\307\071\166"
	"\255\165\313\245\314\011\176\340\234\376\131\224\215\302\045\252"
	"\274\173\275\200\173\213\051\231\022\106\352\057\020\372\000\105"
	"\341\147\212\213\326\040\306\123\173\343\174\112\346\105\163\013"
	"\230\254\327\016\173\061\377\311\216\302\346\354\076\321\177\206"
	"\223\115\057\114\021\217\173\270\356\134\025\213\332\254\344\254"
	"\015\244\362\130\144\146\221\276\263\017\130\215\022\164\341\023"
	"\041\200\275\174\135\036\237\107\307\057\375\135\117\132\310\153"
	"\167\145\106\142\223\146\142\060\234\041\201\313\262\326\005\257"
	"\107\234\361\017\013\232\366\024\122\172\202\060\172\213\333\245"
	"\131\131\165\226\140\061\253\102\331\310\271\322\261\131\254\332"
	"\131\136\013\003\241\002\215\337\173\037\137\346\143\137\303\357"
	"\370\262\052\220\036\013\366\303\142\151\152\131\133\131\271\164"
	"\101\107\025\342\172\326\163\164\253\214\365\337\036\243\023\155"
	"\125\205\273\053\262\270\334\036\270\147\112\306\106\320\000\125"
	"\156\031\351\340\331\012\202\000\071\215\300\006\160\067\307\344"
	"\003\367\202\207\144\011\230\174\237\366\246\235\247\214\252\251"
	"\175\330\236\072\367\003\343\121\120\177\267\156\012\067\076\215"
	"\336\126\345\341\275\203\173\147\063\250\072\034\312\125\326\240"
	"\127\072\056\333\255\143\304\163\046\320\305\134\103\225\327\166"
	"\065\173\205\313\156\076\006\072\114\127\300\172\235\011\370\320"
	"\161\335\201\177\230\177\350\162\177\042\105\136\014\274\330\155"
	"\033\352\247\231\071\127\055\343\303\203\131\071\073\354\376\132"
	"\224\104\342\373\273\161\324\036\350\074\363\367\014\151\003\157"
	"\350\022\036\312\227\124\176\302\171\017\341\156\273\355\113\342"
	"\176\006\151\153\305\231\127\361\270\321\330\177\013\122\067\371"
	"\244\376\056\001\165\045\062\330\233\203\355\213\351\103\031\202"
	"\163\015\053\327\035\220\060\145\360\171\314\113\346\066\016\225"
	"\267\250\346\375\074\162\053\172\134\025\336\327\206\141\237\371"
	"\122\051\314\332\151\342\354\332\157\053\175\214\055\045\316\102"
	"\236\266\111\124\246\174\300\363\242\341\144\250\035\207\155\004"
	"\115\062\356\106\034\050\160\276\323\026\143\110\351\235\327\013"
	"\163\321\240\274\242\030\044\034\343\371\310\067\147\202\372\306"
	"\054\054\155\344\034\026\036\120\166\202\022\117\267\065\062\054"
	"\166\345\002\235\126\131\324\270\036\143\242\163\341\041\224\045"
	"\107\042\044\326\012\266\223\160\211\374\154\362\370\257\142\155"
	"\171\051\204\203\107\144\070\014\273\032\040\102\110\141\321\074"
	"\375\002\347\164\126\104\356\246\126\126\135\000\352\362\146\005"
	"\127\147\015\060\122\124\040\375\105\241\256\241\355\211\305\020"
	"\116\077\375\101\135\357\363\342\040\217\060\325\172\033\340\103"
	"\030\031\037\266\101\016\103\140\041\202\103\222\257\372\163\242"
	"\050\074\333\326\030\144\232\171\217\371\163\165\173\340\055\013"
	"\012\200\023\107\147\325\113\010\012\304\151\243\152\017\166\265"
	"\370\176\371\005\207\324\015\015\326\244\056\120\035\107\130\343"
	"\047\137\226\352\152\057\176\210\131\225\243\146\250\242\342\152"
	"\032\352\300\327\243\111\164\246\155\075\245\322\370\221\341\301"
	"\144\157\307\303\252\357\166\001\345\330\012\145\367\341\301\346"
	"\074\046\077\074\121\130\020\321\040\077\115\020\034\226\013\107"
	"\046\020\203\164\357\202\246\323\223\250\046\334\073\222\047\056"
	"\104\260\253\273\052\256\077\266\175\120\277\253\371\106\006\113"
	"\162\135\147\202\125\223\223\201\042\201\210\163\145\070\353\266"
	"\271\266\120\203\300\153\270\147\021\126\176\357\042\271\341\207"
	"\206\161\373\175\030\254\165\163\216\033\117\254\351\366\035\363"
	"\035\372\255\234\050\221\144\025\143\231\013\167\371\342\215\311"
	"\263\345\123\102\301\117\223\345\102\230\013\104\141\066\144\057"
	"\262\035\243\322\335\133\025\057\343\355\000\017\160\011\154\223"
	"\010\245\110\347\233\342\244\240\366\215\146\373\106\343\122\112"
	"\316\144\311\050\327\233\060\152\200\227\164\326\370\056\002\310"
	"\333\313\210\355\277\205\372\142\052\264\345\053\051\207\200\101"
	"\256\105\142\137\107\164\070\136\360\226\200\037\035\014\307\002"
	"\173\260\144\054\253\070\253\230\362\141\367\070\063\306\317\026"
	"\002\161\050\105\357\252\240\061\276\066\075\134\125\267\317\100"
	"\143\115\372\202\230\256\061\144\114\047\302\063\371\152\375\020"
	"\046\032\232\135\117\302\176\361\211\250\144\033\146\272\275\263"
	"\174\335\072\214\005\311\342\345\162\172\214\376\273\204\122\027"
	"\202\037\204\357\337\262\055\247\222\012\340\263\341\214\333\302"
	"\246\324\310\352\037\117\145\106\255\202\305\025\356\043\145\376"
	"\330\103\360\067\174\076\024\327\135\016\326\033\312\252\076\131"
	"\017\314\173\341\312\060\155\113\224\140\276\322\306\010\057\350"
	"\226\025\242\237\124\336\356\151\001\340\152\131\374\223\002\060"
	"\142\372\310\062\224\313\050\126\167\345\015\223\053\140\251\067"
	"\070\010\272\176\367\057\173\044\007\062\305\223\136\124\135\006"
	"\060\366\237\222\262\301\142\104\265\304\117\363\230\370\016\340"
	"\231\164\320\352\325\265\066\171\211\123\031\366\341\352\341\055"
	"\230\302\313\274\347\072\266\341\140\307\264\155\247\312\256\326"
	"\030\131\021\020\370\330\337\176\062\107\201\313\010\336\222\303"
	"\202\013\063\315\112\202\156\177\274\155\306\063\276\214\320\126"
	"\027\017\374\003\020\261\243\076\000\051\307\347\176\341\071\044"
	"\375\014\241\242\355\352\245\361\070\006\211\260\034\330\045\121"
	"\303\016\023\154\271\007\363\015\073\056\171\346\213\054\330\145"
	"\257\052\015\057\367\025\170\253\077\356\166\330\202\325\157\323"
	"\224\132\054\274\105\073\141\061\375\040\361\003\255\252\121\374"
	"\022\036\371\144\314\133\022\305\224\376\310\372\364\035\310\332"
	"\117\211\006\225\243\350\157\122\127\237\034\316\163\342\047\316"
	"\023\313\162\370\227\173\065\237\230\262\244\337\302\254\174\363"
	"\030\211\352\223\272\247\300\260\007\036\256\176\304\043\202\053"
	"\331\201\022\047\021\326\311\137\352\101\205\220\367\352\013\034"
	"\176\214\337\360\012\335\143\167\215\007\154\302\132\013\152\162"
	"\142\377\125\371\220\363\116\153\116\152\177\202\104\235\001\060"
	"\174\061\245\314\072\200\112\173\364\021\366\365\126\334\004\133"
	"\273\000\140\175\003\255\106\251\004\073\374\046\365\017\007\204"
	"\317\211\276\217\152\261\222\277\031\137\204\277\337\076\327\350"
	"\214\262\057\072\347\173\371\374\002\015\111\045\044\250\017\165"
	"\137\330\164\345\365\053\123\312\247\005\211\144\152\303\243\001"
	"\267\255\023\243\216\112\372\325\326\120\066\330\252\250\336\251"
	"\302\236\224\056\114\224\063\116\336\056\270\027\146\241\323\021"
	"\152\137\025\300\276\342\300\151\175\061\340\026\352\147\273\204"
	"\133\046\257\353\112\057\000\312\337\013\253\364\045\360\310\225"
	"\171\163\131\162\326\214\100\050\354\037\354\263\150\327\046\211"
	"\101\055\021\055\354\203\100\360\151\351\255\303\212\222\173\270"
	"\376\333\327\131\015\223\330\164\060\102\114\162\375\173\071\371"
	"\216\146\317\176\153\121\134\000\351\003\367\175\205\351\350\162"
	"\275\322\307\020\347\335\376\166\363\314\070\056\023\065\303\010"
	"\332\163\060\002\114\150\044\057\026\377\022\001\157\247\372\342"
	"\264\316\226\244\354\235\376\234\234\320\131\303\147\272\240\315"
	"\122\016\305\037\112\337\157\105\137\137\211\105\314\034\175\157"
	"\163\314\163\041\273\007\250\146\211\205\024\120\202\202\372\177"
	"\234\266\057\266\362\016\377\115\070\306\125\065\114\074\026\024"
	"\232\255\042\244\220\302\055\313\162\244\002\150\060\124\101\052"
	"\155\120\117\253\334\070\172\056\030\007\001\111\360\166\354\253"
	"\336\267\170\056\260\022\160\127\032\240\125\301\276\225\012\160"
	"\072\255\134\227\215\362\102\057\005\233\141\310\316\210\102\322"
	"\006\177\160\336\203\055\213\000\056\076\077\043\043\356\240\273"
	"\202\054\146\325\265\035\102\174\225\151\206\212\156\327\102\273"
	"\276\312\363\064\274\107\077\126\172\054\263\324\102\347\257\041"
	"\056\056\310\026\213\045\214\236\006\072\256\151\217\032\241\107"
	"\102\345\121\033\127\160\366\262\162\217\264\363\121\363\155\302"
	"\176\245\365\377\003\235\345\003\360\345\043\276\327\233\151\137"
	"\334\215\366\255\063\270\220\121\002\020\162\275\166\014\377\114"
	"\147\156\336\122\301\164\115\274\064\033\132\256\204\311\107\127"
	"\174\305\011\210\301\035\370\010\240\267\234\152\151\125\332\153"
	"\136\333\016\355\060\016\004\204\154\257\135\122\163\273\236\340"
	"\232\352\201\363\105\052\116\275\270\170\273\177\322\072\031\317"
	"\165\334\002\021\210\360\346\301\136\130\036\004\242\034\001\353"
	"\017\125\135\055\367\356\342\201\151\040\320\236\135\025\116\155"
	"\105\026\033\063\173\270\127\351\216\331\152\240\357\353\352\264"
	"\117\160\240\331\344\366\076\155\120\161\351\160\006\167\150\254"
	"\021\126\072\151\022\357\066\221\157\275\037\317\234\276\150\133"
	"\240\005\277\355\170\371\160\145\362\220\073\320\163\000\361\315"
	"\134\126\030\222\037\353\147\234\371\207\031\042\065\165\046\237"
	"\076\343\140\153\232\065\071\136\122\127\053\243\145\346\214\224"
	"\302\351\034\225\056\314\303\340\164\346\046\067\162\364\307\044"
	"\240\262\017\003\363\126\025\064\235\255\205\034\134\153\355\334"
	"\170\011\074\166\075\053\327\275\047\306\075\053\246\333\012\060"
	"\215\155\343\272\324\026\364\134\112\036\110\354\113\055\142\162"
	"\254\072\357\317\112\200\337\265\027\221\030\130\347\252\100\364"
	"\122\070\256\051\001\327\373\361\253\101\330\251\157\016\260\260"
	"\371\112\140\327\032\215\330\156\116\304\261\371\177\077\003\206"
	"\115\377\270\040\257\243\165\332\332\272\241\153\151\251\114\254"
	"\115\126\006\371\051\015\246\120\061\123\100\154\046\210\016\064"
	"\212\262\256\016\333\042\036\134\072\235\344\275\104\103\172\100"
	"\205\104\373\205\124\106\306\376\130\321\056\025\336\323\047\340"
	"\232\134\346\122\311\271\017\305\174\102\276\130\365\230\321\027"
	"\023\225\124\360\120\047\140\355\374\307\063\045\276\050\054\323"
	"\352\324\025\223\121\213\165\031\105\260\301\162\303\103\262\124"
	"\046\234\166\155\037\217\313\070\010\250\330\331\006\127\312\176"
	"\220\124\370\031\246\036\243\170\331\277\107\306\113\004\142\034"
	"\374\256\161\223\375\105\334\166\025\223\062\000\305\057\000\310"
	"\050\377\371\316\243\221\223\224\341\302\213\123\370\257\307\015"
	"\353\207\030\040\272\222\222\304\176\365\016\042\377\213\161\157"
	"\154\131\074\363\000\063\230\073\322\354\115\371\313\343\263\175"
	"\057\067\033\062\327\307\166\042\365\205\243\271\211\163\047\147"
	"\311\232\365\113\153\304\341\055\240\034\040\254\203\352\102\170"
	"\376\264\376\336\374\044\272\375\216\276\167\340\055\372\003\312"
	"\207\371\176\034\304\025\120\251\113\363\167\263\065\177\274\347"
	"\211\043\233\031\221\162\311\014\222\256\050\231\125\323\005\373"
	"\254\342\362\222\037\152\255\054\035\146\047\163\350\052\125\337"
	"\012\006\161\046\353\160\360\211\015\216\170\163\177\147\101\062"
	"\127\161\316\263\304\220\352\235\253\120\016\155\372\227\246\035"
	"\210\000\365\321\064\355\175\362\251\042\170\035\110\133\150\160"
	"\227\371\023\224\323\242\070\362\060\367\161\357\136\000\177\242"
	"\211\313\264\125\361\313\074\157\247\062\010\032\206\115\236\006"
	"\151\135\060\245\100\311\025\335\342\145\221\162\023\211\252\003"
	"\102\150\041\042\260\160\054\027\221\010\205\063\017\055\374\033"
	"\355\357\074\176\243\052\377\254\024\143\344\100\133\255\260\300"
	"\014\105\051\116\356\213\005\213\105\133\377\372\300\353\010\037"
	"\054\341\114\116\134\153\250\035\203\323\322\000\377\052\164\145"
	"\005\243\317\323\161\116\164\115\272\212\104\207\056\216\375\200"
	"\030\072\026\342\376\104\060\154\031\001\345\150\071\005\107\212"
	"\105\100\156\313\322\021\223\274\336\266\067\021\066\025\134\033"
	"\255\355\111\112\254\376\272\123\120\033\122\016\102\024\077\142"
	"\111\312\024\347\243\043\035\206\023\065\053\170\371\220\307\170"
	"\231\077\136\213\173\055\000\112\240\360\373\004\257\036\103\312"
	"\035\327\367\174\220\140\003\315\037\335\101\112\014\157\002\351"
	"\037\022\210\204\146\230\253\312\062\047\016\146\012\342\123\173"
	"\106\156\334\367\343\050\017\177\211\347\021\053\067\114\063\313"
	"\022\146\134\151\234\270\324\217\345\151\020\337\230\030\346\216"
	"\124\056\277\001\135\041\361\354\171\036\025\363\121\104\175\036"
	"\000\113\025\005\377\050\370\227\346\246\107\172\036\103\111\317"
	"\152\163\327\067\312\024\302\270\240\316\047\146\322\076\307\220"
	"\233\300\277\373\337\306\356\316\050\262\363\074\146\265\236\203"
	"\177\015\272\025\123\237\221\262\062\217\204\123\252\236\021\111"
	"\122\163\343\253\357\105\044\110\071\210\103\360\217\336\176\004"
	"\013\227\040\151\102\214\023\124\152\220\202\317\146\015\227\013"
	"\035\317\034\363\171\064\156\262\145\163\322\334\016\015\247\271"
	"\231\301\307\040\103\077\112\306\100\015\333\141\130\031\362\333"
	"\330\336\254\324\243\233\122\377\057\302\273\014\005\062\341\034"
	"\040\172\174\021\346\117\164\135\231\370\023\156\216\171\140\322"
	"\232\046\363\142\230\153\014\222\235\053\232\027\161\274\343\253"
	"\050\276\202\205\345\156\274\043\177\051\222\127\245\053\051\061"
	"\103\141\377\340\255\004\154\161\042\365\100\345\124\316\276\305"
	"\044\255\006\207\044\355\152\221\203\216\020\304\016\337\061\360"
	"\327\241\243\156\152\127\021\045\266\226\275\306\374\235\074\065"
	"\040\312\245\135\336\342\142\300\251\303\361\141\202\107\350\370"
	"\356\016\137\213\044\065\061\061\136\102\013\363\352\150\105\371"
	"\343\371\166\374\256\165\236\110\277\272\274\000\003\140\337\114"
	"\341\220\264\327\360\031\321\141\207\061\332\133\212\231\032\153"
	"\134\331\205\203\245\350\146\151\107\205\353\077\377\312\137\060"
	"\027\264\015\230\346\377\124\255\124\132\146\350\277\250\150\243"
	"\246\263\212\275\232\145\033\166\164\021\136\110\236\304\065\342"
	"\223\255\144\225\217\015\136\357\175\107\162\242\252\032\243\321"
	"\076\372\303\070\340\242\302\265\104\374\121\276\012\222\203\327"
	"\132\172\217\141\172\124\137\302\341\053\346\136\333\246\340\165"
	"\311\036\020\274\343\242\042\252\227\060\067\072\163\107\355\011"
	"\211\141\323\245\146\226\161\157\000\165\167\271\365\334\311\326"
	"\327\057\312\026\324\320\033\364\056\236\367\170\346\201\201\073"
	"\037\254\321\325\055\374\302\142\024\230\343\003\031\122\105\336"
	"\105\120\007\341\057\002\216\174\072\234\351\342\350\007\122\370"
	"\005\017\237\354\232\235\303\236\307\323\017\174\101\106\221\136"
	"\204\235\070\375\164\325\017\266\170\270\212\237\267\274\102\162"
	"\063\366\114\150\332\055\201\223\152\111\164\103\264\002\153\022"
	"\032\277\311\302\327\151\200\041\321\324\256\062\133\345\067\352"
	"\122\177\231\245\056\341\361\035\142\334\314\041\032\053\162\004"
	"\120\124\264\357\222\247\366\154\257\173\137\320\206\231\071\343"
	"\111\301\232\146\075\207\004\237\124\215\150\104\137\037\032\341"
	"\077\134\103\237\357\062\266\135\001\335\251\367\261\240\356\135"
	"\114\051\167\366\065\301\057\030\073\057\101\130\257\065\115\110"
	"\177\205\354\032\170\130\376\223\022\056\367\166\275\374\100\261"
	"\103\161\332\015\161\036\017\300\112\064\167\017\065\035\334\273"
	"\135\023\133\112\326\037\372\312\167\146\062\056\372\366\207\367"
	"\273\267\344\001\133\027\335\241\032\006\334\226\142\226\123\011"
	"\331\364\035\114\061\273\032\213\174\237\002\144\072\376\076\205"
	"\207\365\075\127\201\203\370\373\302\046\025\224\234\030\050\055"
	"\312\314\366\372\053\344\261\026\106\000\367\352\335\201\061\001"
	"\055\206\212\146\003\042\124\100\222\074\220\057\323\216\147\157"
	"\177\267\323\221\307\253\037\102\362\002\030\377\156\266\213\170"
	"\304\273\107\256\373\351\023\076\370\163\264\136\174\005\025\233"
	"\117\136\362\226\373\007\340\052\040\364\270\020\252\044\312\364"
	"\230\276\071\122\001\306\015\044\151\111\115\104\171\134\127\070"
	"\163\010\355\347\335\236\323\034\134\070\211\152\167\123\335\213"
	"\041\150\373\057\175\367\134\174\306\312\005\131\160\206\367\350"
	"\241\115\133\016\010\376\342\020\011\154\127\103\026\241\011\355"
	"\305\117\337\231\147\050\120\327\024\246\312\006\202\345\251\103"
	"\063\004\122\073\003\064\113\015\241\242\121\267\103\132\245\011"
	"\252\205\243\021\255\363\350\301\232\263\310\035\231\162\140\315"
	"\167\262\010\172\347\124\210\210\367\331\100\073\064\345\104\336"
	"\152\350\357\030\333\330\332\166\214\242\223\045\025\364\362\214"
	"\247\373\007\216\120\217\027\107\151\127\202\235\075\307\173\250"
	"\257\152\300\213\102\232\001\316\075\225\364\122\211\347\336\060"
	"\343\346\277\063\166\327\173\337\057\375\174\154\304\367\024\163"
	"\142\325\376\245\157\000\164\255\225\150\377\037\120\336\120\063"
	"\305\020\147\073\347\342\033\026\340\227\202\244\217\227\030\361"
	"\155\027\227\335\027\013\212\254\164\211\314\304\150\034\370\055"
	"\054\140\150\023\103\203\052\043\033\254\310\252\104\340\234\261"
	"\367\063\217\017\077\031\274\263\243\210\167\013\245\160\070\321"
	"\321\240\345\024\044\017\067\077\274\377\352\001\340\207\263\330"
	"\272\102\347\372\133\244\255\376\054\045\011\322\226\102\243\147"
	"\343\211\173\007\230\262\107\124\262\061\126\222\270\011\153\163"
	"\113\122\155\247\367\033\245\043\100\257\365\326\361\231\075\324"
	"\042\270\334\273\153\043\020\035\125\146\260\016\157\033\202\272"
	"\156\360\142\145\013\007\211\114\267\177\042\251\031\140\176\073"
	"\031\132\366\205\176\006\243\323\154\123\342\334\157\144\227\336"
	"\124\371\104\140\001\316\254\270\115\317\141\146\060\340\242\111"
	"\072\231\316\270\240\162\214\015\305\156\351\065\323\200\024\050"
	"\172\130\211\173\046\065\063\163\005\225\332\065\165\175\177\260"
	"\026\116\151\266\300\366\304\206\145\255\274\070\056\320\141\250"
	"\050\352\044\116\040\127\302\045\355\235\133\143\032\333\024\061"
	"\052\175\350\352\163\254\161\330\132\055\021\211\375\162\062\046"
	"\134\126\165\174\255\070\242\233\325\376\376\360\331\022\042\003"
	"\220\012\356\003\267\140\334\022\215\355\233\213\140\315\262\275"
	"\043\047\072\321\137\334\154\065\332\153\046\264\176\110\270\017"
	"\123\246\023\012\006\357\035\224\335\270\040\076\206\322\373\251"
	"\371\065\173\131\022\350\216\354\123\264\241\322\375\131\342\120"
	"\377\365\133\006\345\170\233\303\061\273\001\267\215\375\140\207"
	"\062\333\340\104\304"
#define      chk1_z	22
#define      chk1	((&data[5440]))
	"\043\010\333\007\066\110\103\374\071\375\137\142\036\130\126\305"
	"\343\202\174\210\237\270\174"
#define      rlax_z	1
#define      rlax	((&data[5462]))
	"\144"
#define      opts_z	1
#define      opts	((&data[5463]))
	"\230"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	0	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
